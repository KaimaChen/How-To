## 脚本

* PortalManager：初始化
* PortalCamera：控制每个门的摄像机位置和旋转（每个门上都要挂这个脚本）
* PortalTeleporter：控制每个门的传送效果（每个门的传送点都要挂这个脚本）



## 做法

* 每个门都有一个摄像机，摄像机的渲染结果放到Render Texture（注意要将门从摄像机的渲染目标中去掉）
* 通过计算主摄像机和目标门的相对位置，来计算出本门摄像机的位置
* 传送门上绑一个Trigger，当角色穿过这个门（点积小于0）时传送到另外一个门的前面（点积大于0），这样就能避免重复触发两个Trigger



## 注意事项

* Render Textures的分辨率要设置为和当前屏幕分辨率一致，否则会有模糊等问题
* RT所在的材质要用屏幕Shader，这样才能看起来像是透过门看到另外一部分世界
* 为了避免摄像机看穿RT这张纸，需要
  * 真正的传送门要在RT前面（距离要把控好）
  * 摄像机的近裁剪面要调小一点
* Unity 2018里的第一人称控制器传送不了（不能硬改位置），因此自己写了一个简单的控制器



## 待改进部分

* 一个门只能传送一个东西
* 两个门的朝向需要刚好相反
* 从门的背面往前走，也会触发传送，虽然因为角度问题会最终回到原地，但仍然有闪烁问题



## 参考

[Smooth PORTALS in Unity](https://www.youtube.com/watch?v=cuQao3hEKfs)

[如何在Unity里制作哆啦a梦任意门效果](https://www.bilibili.com/video/av45314450)

